<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="深圳发票【电话同V信:136-9740-4063杨经理QQ:9190-90380】深圳开发票,住宿餐饮,定额,会议,会务费,材料费,17%增值税,工程建筑票等服务,可提供清单合同,在税务网站查询一致"><meta name="keywords" content="深圳发票,深圳开发票"><title>为什么要使用Cookie呢？ | 深圳开发票,深圳发票-可在网上验证查询</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">为什么要使用Cookie呢？</h1><a id="logo" href="/.">深圳开发票,深圳发票-可在网上验证查询</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">为什么要使用Cookie呢？</h1><div class="post-meta">Jan 16, 2018<span> | </span><span class="category"><a href="/categories/python/">python</a></span></div><div class="post-content"><p>为什么要使用Cookie呢？<br>Cookie，指某些网站为了辨别用户身份、进行session跟踪而储存在用户本地终端上的数据（通常经过加密）<br>比如说有些网站需要登录后才能访问某个页面，在登录之前，你想抓取某个页面内容是不允许的。那么我们可以利用Urllib2库保存我们登录的Cookie，然后再抓取其他页面就达到目的了。<br>在此之前呢，我们必须先介绍一个opener的概念。</p>
<p>1.Opener<br>当你获取一个URL你使用一个opener(一个urllib2.OpenerDirector的实例)。在前面，我们都是使用的默认的opener，也就是urlopen。它是一个特殊的opener，可以理解成opener的一个特殊实例，传入的参数仅仅是url，data，timeout。</p>
<p>如果我们需要用到Cookie，只用这个opener是不能达到目的的，所以我们需要创建更一般的opener来实现对Cookie的设置。</p>
<p>2.Cookielib<br>cookielib模块的主要作用是提供可存储cookie的对象，以便于与urllib2模块配合使用来访问Internet资源。Cookielib模块非常强大，我们可以利用本模块的CookieJar类的对象来捕获cookie并在后续连接请求时重新发送，比如可以实现模拟登录功能。该模块主要的对象有CookieJar、FileCookieJar、MozillaCookieJar、LWPCookieJar。</p>
<p>它们的关系：CookieJar —-派生—-&gt;FileCookieJar  —-派生—–&gt;MozillaCookieJar和LWPCookieJar</p>
<p>1）获取Cookie保存到变量<br>首先，我们先利用CookieJar对象实现获取cookie的功能，存储到变量中，先来感受一下<br>13<br>import urllib2<br>import cookielib</p>
<p>#声明一个CookieJar对象实例来保存cookie<br>cookie = cookielib.CookieJar()</p>
<p>#利用urllib2库的HTTPCookieProcessor对象来创建cookie处理器<br>handler=urllib2.HTTPCookieProcessor(cookie)</p>
<p>#通过handler来构建opener<br>opener = urllib2.build_opener(handler)</p>
<p>#此处的open方法同urllib2的urlopen方法，也可以传入request<br>response = opener.open(‘<a href="http://www.baidu.com" target="_blank" rel="external">http://www.baidu.com</a>‘)<br>for item in cookie:<br>    print ‘Name = ‘+item.name<br>    print ‘Value = ‘+item.value</p>
<p>我们使用以上方法将cookie保存到变量中，然后打印出了cookie中的值，运行结果如下<br>Name = BAIDUID<br>Value = B07B663B645729F11F659C02AAE65B4C:FG=1<br>Name = BAIDUPSID<br>Value = B07B663B645729F11F659C02AAE65B4C<br>Name = H_PS_PSSID<br>Value = 12527_11076_1438_10633<br>Name = BDSVRTM<br>Value = 0<br>Name = BD_HOME<br>Value = 0</p>
<p>2）保存Cookie到文件<br>在上面的方法中，我们将cookie保存到了cookie这个变量中，如果我们想将cookie保存到文件中该怎么做呢？这时，我们就要用到<br>FileCookieJar这个对象了，在这里我们使用它的子类MozillaCookieJar来实现Cookie的保存<br>import cookielib<br>import urllib2</p>
<p>#设置保存cookie的文件，同级目录下的cookie.txt<br>filename = ‘cookie.txt’</p>
<p>#声明一个MozillaCookieJar对象实例来保存cookie，之后写入文件<br>cookie = cookielib.MozillaCookieJar(filename)</p>
<p>#利用urllib2库的HTTPCookieProcessor对象来创建cookie处理器<br>handler = urllib2.HTTPCookieProcessor(cookie)</p>
<p>#通过handler来构建opener<br>opener = urllib2.build_opener(handler)</p>
<p>#创建一个请求，原理同urllib2的urlopen<br>response = opener.open(“<a href="http://www.baidu.com" target="_blank" rel="external">http://www.baidu.com</a>“)</p>
<p>#保存cookie到文件<br>cookie.save(ignore_discard=True, ignore_expires=True)</p>
<p>关于最后save方法的两个参数在此说明一下：</p>
<p>官方解释如下：<br>ignore_discard: save even cookies set to be discarded.<br>ignore_expires: save even cookies that have expiredThe file is overwritten if it already exists</p>
<p>由此可见，ignore_discard的意思是即使cookies将被丢弃也将它保存下来，ignore_expires的意思是如果在该文件中cookies已经存在，则覆盖原文件写入，在这里，我们将这两个全部设置为True。运行之后，cookies将被保存到cookie.txt文件中，我们查看一下内容，附图如下<br>QQ截图20180116151958.jpg</p>
<p> 3）从文件中获取Cookie并访问<br>那么我们已经做到把Cookie保存到文件中了，如果以后想使用，可以利用下面的方法来读取cookie并访问网站，感受一下<br>import cookielib<br>import urllib2</p>
<p>#创建MozillaCookieJar实例对象<br>cookie = cookielib.MozillaCookieJar()</p>
<p>#从文件中读取cookie内容到变量<br>cookie.load(‘cookie.txt’, ignore_discard=True, ignore_expires=True)</p>
<p>#创建请求的request<br>req = urllib2.Request(“<a href="http://www.baidu.com" target="_blank" rel="external">http://www.baidu.com</a>“)</p>
<p>#利用urllib2的build_opener方法创建一个opener<br>opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookie))<br>response = opener.open(req)<br>print response.read()</p>
<p>设想，如果我们的 cookie.txt 文件中保存的是某个人登录百度的cookie，那么我们提取出这个cookie文件内容，就可以用以上方法模拟这个人的账号登录百度。</p>
<p> 4）利用cookie模拟网站登录<br>下面我们以我们学校的教育系统为例，利用cookie实现模拟登录，并将cookie信息保存到文本文件中，来感受一下cookie大法吧！</p>
<p>import urllib<br>import urllib2<br>import cookielib<br>filename = ‘cookie.txt’</p>
<p>#声明一个MozillaCookieJar对象实例来保存cookie，之后写入文件<br>cookie = cookielib.MozillaCookieJar(filename)<br>opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookie))<br>postdata = urllib.urlencode({<br>‘stuid’:’201200131012’,<br>‘pwd’:’23342321’<br>})</p>
<p>#登录教务系统的URL<br>loginUrl = ‘<a href="http://jwxt.sdu.edu.cn:7890/pls/wwwbks/bks_login2.login" target="_blank" rel="external">http://jwxt.sdu.edu.cn:7890/pls/wwwbks/bks_login2.login</a>‘</p>
<p>#模拟登录，并把cookie保存到变量<br>result = opener.open(loginUrl,postdata)</p>
<p>#保存cookie到cookie.txt中<br>cookie.save(ignore_discard=True, ignore_expires=True)</p>
<p>#利用cookie请求访问另一个网址，此网址是成绩查询网址<br>gradeUrl = ‘<a href="http://jwxt.sdu.edu.cn:7890/pls/wwwbks/bkscjcx.curscopre" target="_blank" rel="external">http://jwxt.sdu.edu.cn:7890/pls/wwwbks/bkscjcx.curscopre</a>‘</p>
<p>#请求访问成绩查询网址<br>result = opener.open(gradeUrl)<br>print result.read()</p>
<p>以上程序的原理如下</p>
<p>创建一个带有cookie的opener，在访问登录的URL时，将登录后的cookie保存下来，然后利用这个cookie来访问其他网址。</p>
</div><div class="tags"><a href="/tags/Cookie/">Cookie</a></div><div class="post-nav"><a href="/16.html" class="next">通俗易懂，解读到底什么是区块链？</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="bestwesternpremierbeijing.cn"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 网站标签</i></div><div class="tagcloud"><a href="/tags/区块链/" style="font-size: 15px;">区块链</a> <a href="/tags/智能/" style="font-size: 15px;">智能</a> <a href="/tags/Cookie/" style="font-size: 15px;">Cookie</a> <a href="/tags/要闻/" style="font-size: 15px;">要闻</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 近期文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/python.html">为什么要使用Cookie呢？</a></li><li class="post-list-item"><a class="post-list-link" href="/16.html">通俗易懂，解读到底什么是区块链？</a></li><li class="post-list-item"><a class="post-list-link" href="/zn.html">智能产品的自主创新之道</a></li><li class="post-list-item"><a class="post-list-link" href="/just-test.html">深圳12月二手房成交量小幅回升 业内预计7000套左右</a></li><li class="post-list-item"><a class="post-list-link" href="/hello-world.html">从此开始...</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 内容分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/创新/">创新</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/知识/">知识</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://zhusufap.com/" title="广州开发票" target="_blank">广州开发票</a><ul></ul><a href="http://886r.cn/" title="住宿发票" target="_blank">住宿发票</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">深圳开发票,深圳发票-可在网上验证查询.</a> Powered by<a rel="nofollow" target="_blank" href="http://bestwesternpremierbeijing.cn"> PaiMing.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?4025807967cba2613eedb9db9aadb938";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>